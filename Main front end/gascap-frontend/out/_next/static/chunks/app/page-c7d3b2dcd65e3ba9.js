(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3406:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>n});var a=s(5155),r=s(2115),l=s(574),i=s(4269);let n=l.bL,c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.B8,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});c.displayName=l.B8.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.l9,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});d.displayName=l.l9.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.UC,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});o.displayName=l.UC.displayName},6623:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>V});var a=s(5155),r=s(2115),l=s(7965),i=s(4266);let n="flare_ftso_v7_ticks",c=[],d=!1;var o=s(3406),x=s(1272),m=s(9795),h=s(3063),u=s(944),p=s(2033),f=s(2996),b=s(644);function N(e){let{strikePrice:t,settlementPrice:s,isSettled:l,timeframe:d,onTimeframeChange:N}=e,g=(0,r.useRef)(null),j=(0,r.useRef)(null),v=(0,r.useRef)(null),w=(0,r.useRef)([]),[y,S]=(0,r.useState)(!1),[C,k]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{S(!0)},[]),(0,r.useEffect)(()=>{if(!y||!g.current)return;let e=()=>{var e,t;null==(t=j.current)||t.applyOptions({width:null==(e=g.current)?void 0:e.clientWidth})};return j.current=(0,i.R9)(g.current,{layout:{background:{color:"transparent"},textColor:"#9CA3AF",fontSize:10,fontFamily:"Source Code Pro"},grid:{vertLines:{color:"rgba(255, 255, 255, 0.03)"},horzLines:{color:"rgba(255, 255, 255, 0.03)"}},crosshair:{mode:0,vertLine:{labelBackgroundColor:"#FFB830",color:"rgba(255, 184, 48, 0.4)",style:2},horzLine:{labelBackgroundColor:"#FFB830",color:"rgba(255, 184, 48, 0.4)",style:2}},rightPriceScale:{borderColor:"rgba(255, 255, 255, 0.05)",scaleMargins:{top:.1,bottom:.2}},timeScale:{borderColor:"rgba(255, 255, 255, 0.05)",timeVisible:!0,secondsVisible:!1}}),v.current=j.current.addCandlestickSeries({upColor:"#10B981",downColor:"#EF4444",borderVisible:!1,wickUpColor:"#10B981",wickDownColor:"#EF4444"}),window.addEventListener("resize",e),()=>{var t;window.removeEventListener("resize",e),null==(t=j.current)||t.remove()}},[y]),(0,r.useEffect)(()=>{let e=()=>{if(!v.current)return;let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(0===c.length)try{let e=localStorage.getItem(n);e&&(c=JSON.parse(e))}catch(e){}if(0===c.length)return[];let t=60*e,s=[],a=null,r=null;return c.forEach(e=>{let l=Math.floor(e.time/t)*t;if(a&&a.time===l)a.high=Math.max(a.high,e.price),a.low=Math.min(a.low,e.price),a.close=e.price;else{a&&(s.push(a),r=a.close);let t=null!==r?r:e.price;a={time:l,open:t,high:Math.max(t,e.price),low:Math.min(t,e.price),close:e.price}}}),a&&s.push(a),s.sort((e,t)=>e.time-t.time)}(d);e.length>0?(v.current.setData(e),k(!0)):k(!1),w.current.forEach(e=>{var t;return null==(t=v.current)?void 0:t.removePriceLine(e)}),w.current=[],t&&e.length>0&&w.current.push(v.current.createPriceLine({price:t,color:"#FFB830",lineWidth:1,lineStyle:1,axisLabelVisible:!0,title:"STRIKE"})),l&&s&&e.length>0&&w.current.push(v.current.createPriceLine({price:s,color:"#10B981",lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:"SETTLEMENT"}))};e();let a=setInterval(e,3e3);return()=>clearInterval(a)},[d,t,s,l]),(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-9 border-b border-white/5 bg-white/[0.01] px-4 flex items-center justify-between shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)(o.tU,{value:d.toString(),onValueChange:e=>N(parseInt(e)),children:(0,a.jsx)(o.j7,{className:"bg-transparent h-7 p-0 gap-3",children:["1","5","15","60"].map(e=>(0,a.jsxs)(o.Xi,{value:e,className:"text-[10px] h-6 px-0 min-w-0 rounded-none bg-transparent data-[state=active]:bg-transparent data-[state=active]:text-primary border-b-2 border-transparent data-[state=active]:border-primary transition-all font-bold uppercase tracking-tighter",children:[e,"M"]},e))})}),(0,a.jsx)("div",{className:"h-4 w-px bg-white/10"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-muted-foreground",children:[(0,a.jsx)(x.A,{className:"w-3.5 h-3.5 cursor-pointer hover:text-white transition-colors"}),(0,a.jsx)(m.A,{className:"w-3.5 h-3.5 cursor-pointer hover:text-white transition-colors"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(h.A,{className:"w-3.5 h-3.5 text-muted-foreground cursor-pointer hover:text-white"}),(0,a.jsx)(u.A,{className:"w-3.5 h-3.5 text-muted-foreground cursor-pointer hover:text-white"})]})]}),(0,a.jsxs)("div",{className:"flex-1 relative group bg-black/40",children:[!C&&(0,a.jsxs)("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/60 backdrop-blur-sm gap-4",children:[(0,a.jsx)(p.A,{className:"w-8 h-8 text-primary animate-spin"}),(0,a.jsxs)("div",{className:"text-center space-y-1",children:[(0,a.jsx)("p",{className:"text-xs font-bold uppercase tracking-widest text-white",children:"Connecting to FTSO Feed"}),(0,a.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"Awaiting gas price data from Flare oracle..."})]})]}),(0,a.jsx)("div",{ref:g,className:"w-full h-full"}),(0,a.jsx)("div",{className:"absolute top-4 left-4 z-10 pointer-events-none",children:(0,a.jsx)("div",{className:"bg-black/60 backdrop-blur-md px-3 py-1 rounded-sm border border-white/5 flex items-center gap-2 shadow-2xl",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.A,{className:"w-3 h-3 text-emerald-500"}),(0,a.jsx)("span",{className:"text-[10px] font-bold tracking-widest text-white uppercase",children:"Live FTSO Feed"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.A,{className:"w-3 h-3 text-red-400"}),(0,a.jsx)("span",{className:"text-[10px] font-bold tracking-widest text-muted-foreground uppercase",children:"Waiting for data..."})]})})})]})]})}var g=s(3998),j=s(5142),v=s(6444),w=s(5130),y=s(4269);let S=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsxs)(w.bL,{ref:t,className:(0,y.cn)("relative flex w-full touch-none select-none items-center",s),...r,children:[(0,a.jsx)(w.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(w.Q6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(w.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});S.displayName=w.bL.displayName;var C=s(1647),k=s(5894),F=s(8678),L=s(9794),R=s(6830),E=s(6065),T=s(5039),P=s(6767);function A(e){let{address:t,provider:s,refresh:l,disabled:i,currentPrice:n,contractAddress:c,poolLiquidity:d}=e,[x,m]=(0,r.useState)("LONG"),[h,u]=(0,r.useState)("100"),[p,f]=(0,r.useState)("0.5"),[b,N]=(0,r.useState)(1),[w,A]=(0,r.useState)(!1),{toast:O}=(0,k.dj)(),I=n?Number(n):0,D=parseFloat(p)||0,M=D*b,_=d?Number(d)/1e18:0,G=.8*_,H=_>0&&M>G,U=_>0?M/_*100:0,B=async()=>{if(!t||!s)return void O({title:"Wallet not connected",description:"Please connect MetaMask first.",variant:"destructive"});if(!h||0>=parseInt(h))return void O({title:"Invalid quantity",description:"Enter a valid position size.",variant:"destructive"});if(!p||0>=parseFloat(p))return void O({title:"Invalid collateral",description:"Enter collateral amount in C2FLR.",variant:"destructive"});if(0===_)return void O({title:"No Pool Liquidity",description:"Add liquidity to the pool before trading. Go to Pool page.",variant:"destructive"});if(H){let e=G>0?(G/b).toFixed(4):"0";O({title:"Exposure Exceeds Pool",description:"Max collateral at ".concat(b,"x: ").concat(e," C2FLR"),variant:"destructive"});return}A(!0);try{let e=await s.getSigner(),a=c||R.PI.CONTRACT_ADDRESS,r=new F.NZ(a,R.pQ,e),i=BigInt(h),n=(0,L.XS)(p,"ether");try{if(!(await r.getUserProfile(t))[0]){O({title:"Registering...",description:"First trade â€” registering your account."});let e=await r.registerUser("trader","");await e.wait(),O({title:"Registered!",description:"Account registered. Opening position..."})}}catch(e){try{let e=await r.registerUser("trader","");await e.wait()}catch(e){}}let d="LONG"===x?await r.mintLong(i,BigInt(b),0,{value:n}):await r.mintShort(i,BigInt(b),0,{value:n});O({title:"Transaction Submitted",description:"Opening ".concat(x," position...")}),await d.wait(),O({title:"Position Opened!",description:"".concat(x," ").concat(h," contracts @ ").concat(b,"x with ").concat(p," C2FLR collateral.")}),l()}catch(e){O({title:"Transaction Failed",description:((null==e?void 0:e.reason)||(null==e?void 0:e.message)||"Unknown error").slice(0,200),variant:"destructive"})}finally{A(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col gap-5 py-4 px-3 bg-[#080808]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(C.E,{variant:"outline",className:"text-[9px] h-4 px-1.5 bg-primary/10 text-primary border-primary/20 font-bold uppercase",children:"Futures"}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:(0,y.cn)("w-1.5 h-1.5 rounded-full",I>0?"bg-emerald-500 animate-pulse":"bg-red-500")}),(0,a.jsx)("span",{className:(0,y.cn)("text-[9px] font-bold uppercase tracking-wider",I>0?"text-emerald-400":"text-red-400"),children:I>0?"FTSO Live":"No Feed"})]})]}),(0,a.jsx)(o.tU,{value:x,onValueChange:e=>m(e),className:"w-full",children:(0,a.jsxs)(o.j7,{className:"grid w-full grid-cols-2 h-10 bg-white/5 p-1 rounded-sm",children:[(0,a.jsx)(o.Xi,{value:"LONG",className:"rounded-sm font-black text-[10px] uppercase tracking-wider data-[state=active]:bg-emerald-600 data-[state=active]:text-white",children:"Long"}),(0,a.jsx)(o.Xi,{value:"SHORT",className:"rounded-sm font-black text-[10px] uppercase tracking-wider data-[state=active]:bg-rose-600 data-[state=active]:text-white",children:"Short"})]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex justify-between px-0.5",children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(v.J,{className:"text-[10px] text-muted-foreground uppercase font-bold tracking-tight",children:"Quantity (Contracts)"}),(0,a.jsx)(P.Bc,{children:(0,a.jsxs)(P.m_,{children:[(0,a.jsx)(P.k$,{children:(0,a.jsx)(E.A,{className:"w-3 h-3 text-muted-foreground/50"})}),(0,a.jsx)(P.ZI,{children:"Number of gas futures contracts to open."})]})})]})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(j.p,{type:"number",value:h,onChange:e=>u(e.target.value),className:"bg-white/5 border-white/5 text-white font-code h-11 rounded-sm focus:ring-0 focus:border-white/20 text-sm pr-16",placeholder:"0"}),(0,a.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] text-muted-foreground font-bold uppercase pointer-events-none",children:"Contracts"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex justify-between px-0.5",children:(0,a.jsx)(v.J,{className:"text-[10px] text-muted-foreground uppercase font-bold tracking-tight",children:"Collateral (C2FLR)"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(j.p,{type:"number",value:p,onChange:e=>f(e.target.value),className:"bg-white/5 border-white/5 text-white font-code h-11 rounded-sm focus:ring-0 focus:border-white/20 text-sm pr-16",placeholder:"0.0",step:"0.1"}),(0,a.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] text-muted-foreground font-bold uppercase pointer-events-none",children:"C2FLR"})]})]}),(0,a.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,a.jsx)("div",{className:"flex justify-between px-0.5",children:(0,a.jsx)(v.J,{className:"text-[10px] text-muted-foreground uppercase font-bold tracking-tight",children:"Leverage"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative w-20 shrink-0",children:[(0,a.jsx)(j.p,{type:"number",min:1,max:20,step:1,value:b,onChange:e=>N(Math.min(20,Math.max(1,parseInt(e.target.value)||1))),className:"bg-white/5 border-white/5 text-white font-code h-9 rounded-sm text-sm pr-6 text-center"}),(0,a.jsx)("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-muted-foreground pointer-events-none",children:"x"})]}),(0,a.jsx)(S,{value:[b],onValueChange:e=>N(e[0]),max:20,min:1,step:1,className:"h-1 flex-1"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Collateral"}),(0,a.jsxs)("span",{className:"text-white font-code",children:[D.toFixed(4)," C2FLR"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Leverage"}),(0,a.jsxs)("span",{className:"text-white font-code",children:[b,"x"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Exposure"}),(0,a.jsxs)("span",{className:(0,y.cn)("font-code font-bold",H?"text-rose-400":"text-white"),children:[M.toFixed(4)," C2FLR"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"FTSO Index"}),(0,a.jsx)("span",{className:"text-white font-code",children:I>0?I.toFixed(2):"---"})]}),b>1&&I>0&&(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Est. Liquidation"}),(0,a.jsx)("span",{className:"text-orange-500 font-code font-bold",children:"LONG"===x?(I-I/b).toFixed(2):(I+I/b).toFixed(2)})]}),_>0&&(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Pool Capacity"}),(0,a.jsxs)("span",{className:(0,y.cn)("font-code",U>80?"text-rose-400":U>50?"text-amber-400":"text-emerald-400"),children:[_.toFixed(4)," C2FLR (",U.toFixed(0),"% used)"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Est. Gas Fee"}),(0,a.jsx)("span",{className:"text-white/50 font-code",children:"~0.001 C2FLR"})]}),b>1&&I>0&&D>0&&(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Max Profit"}),(0,a.jsxs)("span",{className:"text-emerald-400 font-code font-bold",children:["+",(D*(b-1)).toFixed(4)," C2FLR"]})]}),D>0&&(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Max Loss"}),(0,a.jsxs)("span",{className:"text-rose-400 font-code font-bold",children:["-",D.toFixed(4)," C2FLR"]})]}),_>0&&_<.1&&(0,a.jsx)("div",{className:"text-[9px] text-amber-400/80 bg-amber-500/10 border border-amber-500/20 rounded-sm px-2 py-1",children:"Pool needs liquidity before trading. Add liquidity first."}),H&&(0,a.jsxs)("div",{className:"text-[9px] text-rose-400/80 bg-rose-500/10 border border-rose-500/20 rounded-sm px-2 py-1",children:["Exposure exceeds 80% of pool. Max at ",b,"x: ",G>0?(G/b).toFixed(4):"0"," C2FLR collateral"]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Contract"}),(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/address/").concat(c||R.PI.CONTRACT_ADDRESS),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 font-code text-[10px] hover:underline",children:[(c||R.PI.CONTRACT_ADDRESS).slice(0,6),"...",(c||R.PI.CONTRACT_ADDRESS).slice(-4)]})]})]}),(0,a.jsx)(g.$,{className:(0,y.cn)("w-full font-black h-14 uppercase tracking-[0.2em] rounded-sm text-xs transition-all active:scale-[0.98] shadow-lg","LONG"===x?"bg-emerald-600 hover:bg-emerald-700 text-white shadow-emerald-500/20":"bg-rose-600 hover:bg-rose-700 text-white shadow-rose-500/20"),disabled:w||i||!t,onClick:B,children:t?w?"PENDING...":"LONG"===x?"Open Long ".concat(b,"x"):"Open Short ".concat(b,"x"):"CONNECT WALLET"}),(0,a.jsxs)("div",{className:"mt-auto pt-4 border-t border-white/5 flex items-start gap-3 text-[9px] text-muted-foreground leading-relaxed italic",children:[(0,a.jsx)(T.A,{className:"w-4 h-4 shrink-0 text-orange-500/50"}),(0,a.jsx)("p",{children:"GasCap Futures settle based on FTSO oracle prices. Powered by Flare Network. Testnet only."})]})]})}var O=s(1851),I=s(2925),D=s(4915);function M(e){let{position:t,address:s,contractState:l,provider:i,refresh:n,currentPrice:c,contractAddress:d,recentTrades:x=[]}=e,[m,h]=(0,r.useState)("POSITIONS"),[u,p]=(0,r.useState)(!1),{toast:f}=(0,k.dj)(),b=async()=>{if(i){p(!0);try{let e=await i.getSigner(),t=d||R.PI.CONTRACT_ADDRESS,s=new F.NZ(t,R.pQ,e),a=await s.claimPayout();await a.wait(),f({title:"Payout Claimed",description:"Settlement payout received successfully."}),n()}catch(e){f({title:"Claim Failed",description:(null==e?void 0:e.reason)||(null==e?void 0:e.message)||"Unknown error",variant:"destructive"})}finally{p(!1)}}},N=t&&t.exists&&BigInt(t.quantity)>0n,j=(()=>{if(!N||!c||!t)return null;let e=Number(c),s=Number(t.entryPrice),a=Number(t.leverage);return s<=0||e<=0?null:t.isLong?(e-s)/s*a*100:(s-e)/s*a*100})(),v=(()=>{if(!N||!t||!l)return null;let e=Number((0,L.Js)(t.collateralWei,18)),s=Number(t.leverage),a=Number(l.strikePriceGwei),r=l.isSettled?Number(l.settlementPriceGwei):c?Number(c):0;if(a<=0||r<=0||e<=0)return null;if(!(t.isLong?r>a:r<a))return{payout:0,profit:-e,gasFee:.001};let i=e*s*(t.isLong?r-a:a-r)/a,n=e*(s-1);return i>n&&(i=n),{payout:e+i,profit:i,gasFee:.001}})(),w=d||R.PI.CONTRACT_ADDRESS,S="text-[10px] h-full px-0 min-w-0 rounded-none bg-transparent data-[state=active]:bg-transparent data-[state=active]:text-primary border-b-2 border-transparent data-[state=active]:border-primary transition-all font-bold uppercase tracking-wider";return(0,a.jsxs)(o.tU,{value:m,onValueChange:h,className:"h-full flex flex-col bg-[#0a0a0a]",children:[(0,a.jsx)("div",{className:"h-10 border-b border-white/5 flex items-center px-4 justify-between bg-white/[0.01]",children:(0,a.jsxs)(o.j7,{className:"bg-transparent h-full p-0 gap-6",children:[(0,a.jsxs)(o.Xi,{value:"POSITIONS",className:S,children:["Positions (",+!!N,")"]}),(0,a.jsx)(o.Xi,{value:"CONTRACT",className:S,children:"Contract Info"}),(0,a.jsxs)(o.Xi,{value:"HISTORY",className:S,children:["Tx History (",x.length,")"]})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,a.jsx)(o.av,{value:"POSITIONS",className:"m-0 h-full",children:N?(0,a.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full text-[11px] font-code border-collapse",children:[(0,a.jsx)("thead",{className:"text-muted-foreground uppercase font-bold border-b border-white/5 bg-white/[0.01] sticky top-0 z-10",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Market"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Side"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Size"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Entry"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Collateral"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"P&L"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Status"}),(0,a.jsx)("th",{className:"text-right py-3 px-3 font-bold",children:"Action"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-white/[0.03]",children:(0,a.jsxs)("tr",{className:"hover:bg-white/[0.02] transition-colors",children:[(0,a.jsx)("td",{className:"py-3 px-3 font-bold text-white uppercase text-[10px]",children:"GAS-FUT"}),(0,a.jsx)("td",{className:"py-3 px-3",children:(0,a.jsxs)(C.E,{className:(0,y.cn)("text-[9px] h-4 rounded-sm border-none font-black",t.isLong?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"),children:[t.isLong?"LONG":"SHORT"," ",t.leverage.toString(),"x"]})}),(0,a.jsx)("td",{className:"py-3 px-3 text-white",children:t.quantity.toString()}),(0,a.jsx)("td",{className:"py-3 px-3 text-white/70",children:Number(t.entryPrice)>0?Number(t.entryPrice).toFixed(2):"---"}),(0,a.jsxs)("td",{className:"py-3 px-3 text-white/70",children:[parseFloat((0,L.Js)(t.collateralWei,18)).toFixed(4)," C2FLR"]}),(0,a.jsx)("td",{className:"py-3 px-3",children:null!==j?(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:(0,y.cn)("font-bold",j>=0?"text-emerald-400":"text-rose-400"),children:[j>=0?"+":"",j.toFixed(2),"%"]}),(0,a.jsxs)("span",{className:(0,y.cn)("text-[9px]",j>=0?"text-emerald-400/60":"text-rose-400/60"),children:[j>=0?"+":"",(Number((0,L.Js)(t.collateralWei,18))*j/100).toFixed(4)," C2FLR"]})]}):(0,a.jsx)("span",{className:"text-muted-foreground/50",children:"---"})}),(0,a.jsx)("td",{className:"py-3 px-3",children:(0,a.jsx)("span",{className:(0,y.cn)("text-[10px] font-bold uppercase",t.isClaimed?"text-emerald-400":(null==l?void 0:l.isSettled)?"text-orange-400":"text-white/40"),children:t.isClaimed?"CLAIMED":(null==l?void 0:l.isSettled)?"SETTLEABLE":"OPEN"})}),(0,a.jsx)("td",{className:"py-3 px-3 text-right",children:(null==l?void 0:l.isSettled)&&!t.isClaimed&&(0,a.jsx)(g.$,{size:"sm",className:"h-7 px-3 bg-primary hover:bg-primary/80 text-primary-foreground text-[10px] uppercase font-bold",onClick:b,disabled:u,children:u?"Claiming...":"Claim"})})]})})]}),N&&v&&(0,a.jsx)("div",{className:"px-3 py-2 border-t border-white/5 bg-white/[0.01]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-[10px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground uppercase font-bold",children:(null==l?void 0:l.isSettled)?"Settlement Payout":"Est. Payout"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:v.payout>0?(0,a.jsxs)("span",{className:"text-emerald-400 font-bold font-code",children:[v.payout.toFixed(4)," C2FLR",(0,a.jsxs)("span",{className:"text-emerald-400/50 ml-1",children:["(~",v.gasFee.toFixed(3)," gas)"]})]}):(0,a.jsx)("span",{className:"text-rose-400 font-bold font-code",children:"0 C2FLR (lost collateral)"})})]})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-2 text-muted-foreground/30",children:[(0,a.jsx)(O.A,{className:"w-8 h-8 opacity-20"}),(0,a.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest italic",children:"No Open Positions"}),(0,a.jsx)("span",{className:"text-[10px] text-muted-foreground/20",children:"Connect wallet and open a position to start trading"})]})}),(0,a.jsx)(o.av,{value:"CONTRACT",className:"m-0 h-full p-4",children:(0,a.jsxs)("div",{className:"space-y-3 font-code text-[11px]",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Type"}),(0,a.jsx)("span",{className:"text-amber-400 font-bold",children:"Cash-Settled Futures (Expiry)"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Market Contract"}),(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/address/").concat(w),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline flex items-center gap-1",children:[w.slice(0,10),"...",w.slice(-8)," ",(0,a.jsx)(I.A,{className:"w-3 h-3"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Factory"}),(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/address/").concat(R.PI.FACTORY_ADDRESS),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400/60 hover:underline flex items-center gap-1 text-[10px]",children:[R.PI.FACTORY_ADDRESS.slice(0,10),"...",R.PI.FACTORY_ADDRESS.slice(-8)," ",(0,a.jsx)(I.A,{className:"w-3 h-3"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Network"}),(0,a.jsxs)("span",{className:"text-white",children:["Flare Coston2 (Chain ",R.PI.CHAIN_ID,")"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Strike Price"}),(0,a.jsx)("span",{className:"text-white",children:l?l.strikePriceGwei.toString():"---"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Expiry Date"}),(0,a.jsx)("span",{className:"text-white",children:l?new Date(1e3*Number(l.expiryTimestamp)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"})+" UTC":"---"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Settled"}),(0,a.jsx)("span",{className:(null==l?void 0:l.isSettled)?"text-emerald-400":"text-white",children:(null==l?void 0:l.isSettled)?"Yes":"No"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Participants"}),(0,a.jsx)("span",{className:"text-white",children:(null==l?void 0:l.participantCount.toString())||"0"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Pool Liquidity"}),(0,a.jsxs)("span",{className:"text-white",children:[l?(Number(l.totalLiquidityWei)/1e18).toFixed(4):"0"," C2FLR"]})]}),(0,a.jsxs)("div",{className:"border-t border-white/5 pt-3 mt-3 space-y-2",children:[(0,a.jsx)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest",children:"How Markets Work"}),(0,a.jsxs)("div",{className:"text-[10px] text-muted-foreground/70 leading-relaxed",children:["The ",(0,a.jsx)("span",{className:"text-blue-400",children:"Factory"})," deploys independent ",(0,a.jsx)("span",{className:"text-amber-400",children:"Market Contracts"}),". Each market is its own contract with its own strike, expiry, and liquidity pool. The market selector in the header picks which contract you interact with."]})]}),(0,a.jsxs)("div",{className:"border-t border-white/5 pt-3 mt-3 space-y-3",children:[(0,a.jsx)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest",children:"Settlement Details"}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Oracle"}),(0,a.jsx)("span",{className:"text-white",children:"FTSO V2 (BTC 50% + ETH 30% + FLR 20%)"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Settlement"}),(0,a.jsx)("span",{className:"text-white",children:"Cash-settled in C2FLR"})]}),(null==l?void 0:l.isSettled)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Settlement Price"}),(0,a.jsx)("span",{className:"text-emerald-400 font-bold",children:l.settlementPriceGwei.toString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Outcome"}),(0,a.jsx)("span",{className:(0,y.cn)("font-bold",Number(l.settlementPriceGwei)>Number(l.strikePriceGwei)?"text-emerald-400":"text-rose-400"),children:Number(l.settlementPriceGwei)>Number(l.strikePriceGwei)?"Longs profit":"Shorts profit"})]})]})]})]})}),(0,a.jsx)(o.av,{value:"HISTORY",className:"m-0 h-full",children:0===x.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-2 text-muted-foreground/30",children:[(0,a.jsx)(D.A,{className:"w-8 h-8 opacity-20"}),(0,a.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest italic",children:"No Transactions"}),(0,a.jsx)("span",{className:"text-[10px] text-muted-foreground/20",children:"Trade activity will appear here with explorer links"})]}):(0,a.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full text-[11px] font-code border-collapse",children:[(0,a.jsx)("thead",{className:"text-muted-foreground uppercase font-bold border-b border-white/5 bg-white/[0.01] sticky top-0 z-10",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Tx Hash"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Side"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Size"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Collateral"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Lev"}),(0,a.jsx)("th",{className:"text-left py-3 px-3 font-bold",children:"Time"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-white/[0.03]",children:x.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-white/[0.02] transition-colors",children:[(0,a.jsx)("td",{className:"py-2 px-3",children:(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/tx/").concat(e.txHash),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline flex items-center gap-1",children:[e.txHash.slice(0,10),"...",e.txHash.slice(-6),(0,a.jsx)(I.A,{className:"w-3 h-3 shrink-0"})]})}),(0,a.jsx)("td",{className:"py-2 px-3",children:(0,a.jsx)(C.E,{className:(0,y.cn)("text-[9px] h-4 rounded-sm border-none font-black",e.isLong?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"),children:e.isLong?"LONG":"SHORT"})}),(0,a.jsx)("td",{className:"py-2 px-3 text-white",children:e.quantity.toString()}),(0,a.jsx)("td",{className:"py-2 px-3 text-white/70",children:parseFloat((0,L.Js)(e.collateral,18)).toFixed(4)}),(0,a.jsxs)("td",{className:"py-2 px-3 text-white/70",children:[e.leverage.toString(),"x"]}),(0,a.jsx)("td",{className:"py-2 px-3 text-muted-foreground text-[10px]",children:new Date(1e3*e.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})})]},e.txHash))})]}),(0,a.jsx)("div",{className:"px-3 py-2 border-t border-white/5 bg-white/[0.01]",children:(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/address/").concat(w),target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-blue-400/60 hover:text-blue-400 flex items-center gap-1",children:["View all transactions on Explorer ",(0,a.jsx)(I.A,{className:"w-3 h-3"})]})})]})})]})]})}var _=s(2265),G=s(4374),H=s(2863),U=s(212),B=s(2593),W=s(6874),X=s(6943);let q=[{label:"1 Hour",seconds:3600},{label:"6 Hours",seconds:21600},{label:"24 Hours",seconds:86400},{label:"48 Hours",seconds:172800},{label:"1 Week",seconds:604800}];function J(e){let{currentPrice:t,contractState:s,contractAddress:l,recentTrades:i=[],provider:n,onMarketCreated:c}=e,[d,x]=(0,r.useState)("MARKET"),[m,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)(Math.floor(Date.now()/1e3)),{toast:f}=(0,k.dj)(),[b,N]=(0,r.useState)("50"),[w,S]=(0,r.useState)(3),[C,E]=(0,r.useState)(""),[T,P]=(0,r.useState)(!1);(0,r.useEffect)(()=>{h(!0)},[]),(0,r.useEffect)(()=>{let e=setInterval(()=>p(Math.floor(Date.now()/1e3)),1e3);return()=>clearInterval(e)},[]);let A=l||R.PI.CONTRACT_ADDRESS,D=t?Number(t):0,M=s?Number(s.strikePriceGwei):0,J=(s?Number(s.expiryTimestamp):0)-u,z=J<=0,V=s?Number((0,L.Js)(s.totalLiquidityWei,18)):0,Y=s?Number(s.participantCount):0,Q=D>0&&M>0?D-M:0,Z=M>0?Q/M*100:0,K=Q>0,$=async()=>{if(!n)return void f({title:"Wallet not connected",description:"Connect your wallet first.",variant:"destructive"});let e=parseInt(b);if(!e||e<=0)return void f({title:"Invalid strike",description:"Enter a valid strike price.",variant:"destructive"});let t=C.trim()||"GCAP-".concat(e),s=q[w].seconds;P(!0);try{let a=await n.getSigner(),r=new F.NZ(R.PI.FACTORY_ADDRESS,R.QJ,a),l=await r.createMarket(e,s,t,"Gas futures with strike ".concat(e,", expiry ").concat(q[w].label));f({title:"Creating Market...",description:"Transaction submitted."});let i=(await l.wait()).logs.find(e=>{try{let t=r.interface.parseLog({topics:e.topics,data:e.data});return(null==t?void 0:t.name)==="MarketCreated"||(null==t?void 0:t.name)==="FuturesCreated"}catch(e){return!1}}),d="";if(i){let e=r.interface.parseLog({topics:i.topics,data:i.data});d=(null==e?void 0:e.args[0])||""}f({title:"Market Created!",description:d?"".concat(t," deployed at ").concat(d.slice(0,8),"..."):"".concat(t," created successfully.")}),d&&c&&c(d)}catch(e){f({title:"Creation Failed",description:(null==e?void 0:e.reason)||(null==e?void 0:e.message)||"Unknown error",variant:"destructive"})}finally{P(!1)}};return m?(0,a.jsxs)("div",{className:"h-full flex flex-col bg-[#080808]",children:[(0,a.jsx)("div",{className:"h-10 border-b border-white/5 flex items-center px-3 bg-white/[0.01]",children:(0,a.jsx)(o.tU,{value:d,onValueChange:x,className:"w-full",children:(0,a.jsx)(o.j7,{className:"bg-transparent h-8 p-0 gap-3",children:["MARKET","TRADES","CREATE"].map(e=>(0,a.jsx)(o.Xi,{value:e,className:"text-[10px] h-full px-0 min-w-0 rounded-none bg-transparent data-[state=active]:bg-transparent data-[state=active]:text-primary border-b-2 border-transparent data-[state=active]:border-primary transition-all font-bold uppercase tracking-widest",children:"CREATE"===e?(0,a.jsxs)("span",{className:"flex items-center gap-0.5",children:[(0,a.jsx)(_.A,{className:"w-2.5 h-2.5"}),e]}):e},e))})})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden p-3",children:"MARKET"===d?(0,a.jsxs)("div",{className:"flex flex-col h-full font-code text-[11px] space-y-3 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-3",children:[(0,a.jsxs)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest mb-2 flex items-center gap-1.5",children:[(0,a.jsx)(O.A,{className:"w-3 h-3 text-emerald-500"}),"FTSO Gas Index (Live)"]}),(0,a.jsxs)("div",{className:"flex items-end justify-between",children:[(0,a.jsx)("span",{className:(0,y.cn)("text-2xl font-bold leading-none",D>0?"text-emerald-400":"text-muted-foreground"),children:D>0?D.toFixed(2):"---"}),D>0&&(0,a.jsxs)("div",{className:(0,y.cn)("flex items-center gap-1 text-[10px] font-bold",K?"text-emerald-400":"text-rose-400"),children:[K?(0,a.jsx)(G.A,{className:"w-3 h-3"}):(0,a.jsx)(H.A,{className:"w-3 h-3"}),Q>0?"+":"",Q.toFixed(2)," (",Z>0?"+":"",Z.toFixed(1),"%)"]})]}),(0,a.jsx)("div",{className:"text-[9px] text-muted-foreground mt-1",children:"BTC(50%) + ETH(30%) + FLR(20%) weighted index"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-2.5",children:[(0,a.jsxs)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest flex items-center gap-1 mb-1",children:[(0,a.jsx)(U.A,{className:"w-3 h-3 text-amber-500"}),"Strike"]}),(0,a.jsx)("span",{className:"text-white font-bold text-sm",children:M>0?M:"---"})]}),(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-2.5",children:[(0,a.jsxs)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest flex items-center gap-1 mb-1",children:[(0,a.jsx)(B.A,{className:(0,y.cn)("w-3 h-3",z?"text-red-400":"text-blue-400")}),"Expiry"]}),(0,a.jsx)("span",{className:(0,y.cn)("font-bold text-sm",(null==s?void 0:s.isSettled)?"text-emerald-400":z?"text-red-400":"text-orange-400"),children:(null==s?void 0:s.isSettled)?"SETTLED":(()=>{if(z)return"EXPIRED";let e=Math.floor(J/3600),t=Math.floor(J%3600/60);return"".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"),":").concat((J%60).toString().padStart(2,"0"))})()})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-2.5",children:[(0,a.jsxs)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest flex items-center gap-1 mb-1",children:[(0,a.jsx)(W.A,{className:"w-3 h-3 text-cyan-400"}),"Pool"]}),(0,a.jsx)("span",{className:"text-white font-bold text-sm",children:V.toFixed(4)}),(0,a.jsx)("span",{className:"text-[9px] text-muted-foreground ml-1",children:"C2FLR"})]}),(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-2.5",children:[(0,a.jsxs)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest flex items-center gap-1 mb-1",children:[(0,a.jsx)(X.A,{className:"w-3 h-3 text-purple-400"}),"Traders"]}),(0,a.jsx)("span",{className:"text-white font-bold text-sm",children:Y})]})]}),(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-3",children:[(0,a.jsx)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest mb-2",children:"Settlement Outlook"}),(null==s?void 0:s.isSettled)?(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Settlement Price"}),(0,a.jsx)("span",{className:"text-emerald-400 font-bold",children:Number(s.settlementPriceGwei)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Outcome"}),(0,a.jsx)("span",{className:(0,y.cn)("font-bold",Number(s.settlementPriceGwei)>M?"text-emerald-400":"text-rose-400"),children:Number(s.settlementPriceGwei)>M?"LONGS WIN":"SHORTS WIN"})]})]}):D>0?(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"If settled now"}),(0,a.jsx)("span",{className:(0,y.cn)("font-bold",K?"text-emerald-400":"text-rose-400"),children:K?"LONGS win":"SHORTS win"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Distance to strike"}),(0,a.jsxs)("span",{className:"text-white font-bold",children:[Math.abs(Q).toFixed(2)," (",Math.abs(Z).toFixed(1),"%)"]})]})]}):(0,a.jsx)("span",{className:"text-muted-foreground/50 italic",children:"Awaiting FTSO feed..."})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-[9px] pt-1 border-t border-white/[0.05]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Contract"}),(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/address/").concat(A),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline flex items-center gap-1",children:[A.slice(0,8),"...",A.slice(-6),(0,a.jsx)(I.A,{className:"w-2.5 h-2.5"})]})]})]}):"TRADES"===d?(0,a.jsx)("div",{className:"h-full flex flex-col font-code text-[10px] space-y-1 overflow-y-auto",children:0===i.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full opacity-20 italic",children:[(0,a.jsx)(O.A,{className:"w-8 h-8 mb-2"}),"No On-Chain Trades Yet"]}):i.map(e=>(0,a.jsxs)("div",{className:"flex flex-col border-b border-white/[0.03] py-2 px-1 hover:bg-white/[0.02]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:(0,y.cn)("font-bold",e.isLong?"text-emerald-500":"text-rose-500"),children:e.isLong?"LONG":"SHORT"}),(0,a.jsxs)("span",{className:"text-white/80",children:[e.quantity.toString()," @ ",e.leverage.toString(),"x"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center opacity-40 text-[9px]",children:[(0,a.jsxs)("span",{children:[e.trader.slice(0,6),"...",e.trader.slice(-4)]}),(0,a.jsx)("span",{children:new Date(1e3*e.timestamp).toLocaleTimeString()})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 text-[8px] opacity-30 mt-0.5",children:(0,a.jsxs)("a",{href:"".concat(R.PI.EXPLORER_URL,"/tx/").concat(e.txHash),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 hover:underline flex items-center gap-0.5",children:["tx: ",e.txHash.slice(0,6),"...",e.txHash.slice(-4),(0,a.jsx)(I.A,{className:"w-2 h-2"})]})})]},e.txHash))}):(0,a.jsxs)("div",{className:"flex flex-col h-full font-code text-[11px] space-y-4 overflow-y-auto",children:[(0,a.jsx)("div",{className:"text-[9px] text-muted-foreground font-bold uppercase tracking-widest",children:"Create New Futures Market"}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)(v.J,{className:"text-[10px] text-muted-foreground uppercase font-bold",children:"Market Name"}),(0,a.jsx)(j.p,{value:C,onChange:e=>E(e.target.value),placeholder:"e.g. ETH Gas Bull",className:"bg-white/5 border-white/5 text-white font-code h-9 rounded-sm text-sm"})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)(v.J,{className:"text-[10px] text-muted-foreground uppercase font-bold",children:"Strike Price (Index)"}),(0,a.jsx)(j.p,{type:"number",value:b,onChange:e=>N(e.target.value),placeholder:"50",className:"bg-white/5 border-white/5 text-white font-code h-9 rounded-sm text-sm"}),(0,a.jsxs)("div",{className:"text-[8px] text-muted-foreground/50",children:["Current index: ",D>0?D.toFixed(2):"---"," | Suggested: ",D>0?Math.round(D):50]})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)(v.J,{className:"text-[10px] text-muted-foreground uppercase font-bold",children:"Expiry Duration"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-1.5",children:q.map((e,t)=>(0,a.jsx)("button",{onClick:()=>S(t),className:(0,y.cn)("text-[9px] py-1.5 rounded-sm border transition-all font-bold",t===w?"bg-primary/20 border-primary/40 text-primary":"bg-white/5 border-white/5 text-muted-foreground hover:bg-white/10"),children:e.label},e.label))})]}),(0,a.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-sm p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[10px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Strike"}),(0,a.jsx)("span",{className:"text-white font-bold",children:b||"50"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[10px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Duration"}),(0,a.jsx)("span",{className:"text-white font-bold",children:q[w].label})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[10px]",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Factory"}),(0,a.jsxs)("span",{className:"text-blue-400 font-code text-[8px]",children:[R.PI.FACTORY_ADDRESS.slice(0,8),"...",R.PI.FACTORY_ADDRESS.slice(-6)]})]})]}),(0,a.jsx)(g.$,{onClick:$,disabled:T||!n,className:"w-full h-10 bg-primary hover:bg-primary/80 text-primary-foreground font-bold uppercase tracking-wider text-[10px] rounded-sm",children:T?"Creating...":n?"Create Market":"Connect Wallet"})]})})]}):(0,a.jsx)("div",{className:"h-full bg-[#080808]"})}var z=s(4730);function V(){let{address:e,provider:t,connect:s}=(0,z.vT)(),[i,o]=(0,r.useState)(()=>localStorage.getItem("gascap_selected_market")||R.PI.CONTRACT_ADDRESS),{markets:x,loading:m,refresh:h}=(0,z.Gb)();(0,r.useEffect)(()=>{localStorage.setItem("gascap_selected_market",i)},[i]);let{contractState:u,currentGasPrice:p,userPosition:f,recentTrades:b,connectionError:g,refresh:j}=(0,z.Qu)(e,i),[v,w]=(0,r.useState)(1);return(0,r.useEffect)(()=>{if(p&&p.price>0n){let e=Number(p.price),t=Number(p.timestamp);!function(e,t){if(d||e<=0)return;if(c.length>=30){d=!0;return}d=!0;let s=[],a=e*(.92+.16*Math.random()),r=Math.max(1,.75*e),l=1.25*e,i=0;for(let n=360;n>0;n--){let c=(e-a)*.002,d=.008*e*(.5+Math.random());a=Math.max(r,Math.min(l,a+(c+(i=.85*i+(Math.random()-.5)*.4)*d*.1+(Math.random()-.5)*d))),s.push({price:parseFloat(a.toFixed(2)),time:t-5*n})}s.push({price:e,time:t-1}),c=[...s,...c];try{localStorage.setItem(n,JSON.stringify(c))}catch(e){}}(e,t),function(e){if(e.price&&!(e.price<=0)){if(0===c.length)try{let e=localStorage.getItem(n);e&&(c=JSON.parse(e))}catch(e){}if((!(c.length>0)||c[c.length-1].time!==e.time)&&(!(c.length>0)||c[c.length-1].price!==e.price||!(e.time-c[c.length-1].time<10))){c.push(e),c.length>2e3&&c.shift();try{localStorage.setItem(n,JSON.stringify(c))}catch(e){}}}}({price:e,time:t})}},[p]),(0,a.jsxs)("div",{className:"flex flex-col h-screen bg-[#050505] text-foreground font-body overflow-hidden",children:[(0,a.jsx)(l.Y,{address:e,gasPrice:p,state:u,onConnect:s,connectionError:g,markets:x,selectedMarket:i,onSelectMarket:o,marketsLoading:m}),(0,a.jsxs)("main",{className:"flex-1 flex min-h-0 overflow-hidden border-t border-white/5",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 border-r border-white/5",children:[(0,a.jsx)("div",{className:"flex-[3] flex flex-col min-h-0 bg-black/20",children:(0,a.jsx)("div",{className:"flex-1 relative",children:(0,a.jsx)(N,{strikePrice:u?Number(u.strikePriceGwei):void 0,settlementPrice:u?Number(u.settlementPriceGwei):void 0,isSettled:null==u?void 0:u.isSettled,timeframe:v,onTimeframeChange:w})})}),(0,a.jsx)("div",{className:"flex-[2] border-t border-white/5 min-h-0",children:(0,a.jsx)(M,{position:f,address:e,contractState:u,provider:t,refresh:j,currentPrice:null==p?void 0:p.price,contractAddress:i,recentTrades:b})})]}),(0,a.jsxs)("div",{className:"w-[320px] flex flex-col shrink-0",children:[(0,a.jsx)("div",{className:"flex-1 border-b border-white/5 overflow-hidden",children:(0,a.jsx)(J,{currentPrice:null==p?void 0:p.price,contractState:u,contractAddress:i,recentTrades:b,provider:t,onMarketCreated:e=>{o(e),h()}})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto bg-black/40",children:(0,a.jsx)(A,{address:e,provider:t,refresh:j,disabled:(null==u?void 0:u.isSettled)||!e,currentPrice:null==p?void 0:p.price,contractAddress:i,poolLiquidity:null==u?void 0:u.totalLiquidityWei})})]})]})]})}},8868:(e,t,s)=>{Promise.resolve().then(s.bind(s,6623))}},e=>{e.O(0,[975,361,184,160,118,740,754,478,494,441,255,358],()=>e(e.s=8868)),_N_E=e.O()}]);